# 同态滤波实验

本程序实现了同态滤波器，用于处理图像中的乘性噪声。同态滤波是一种非线性图像处理技术，特别适用于处理具有不均匀照明或乘性噪声的图像。

## 实验原理

同态滤波的基本原理是将乘性噪声转换为加性噪声，然后在频域中进行滤波：

1. 对数变换：将乘性噪声转换为加性噪声
2. 傅里叶变换：将信号转换到频域
3. 频域滤波：应用增益曲线抑制噪声频率
4. 逆傅里叶变换：将信号转回空域
5. 指数变换：恢复原始的动态范围

## 项目文件

```
.
├── README.md                   # 项目说明文档
├── requirements.txt            # 项目依赖
├── homomorphic_filter_app.py   # 同态滤波程序
└── images/                     # 图像目录
    └── test.jpg                # 测试图像
```

## 安装依赖

```bash
pip install numpy opencv-python matplotlib
```

## 使用方法

```bash
python homomorphic_filter_app.py [选项]
```

选项:
- `-i, --input`：输入图像路径（默认: images/test.jpg）
- `-o, --output`：输出图像路径（默认: images/result.png）
- `-c, --cutoff`：高斯滤波器的截止频率（默认: 40.0）
- `-gl, --gamma_l`：同态滤波器低频增益（默认: 0.5）
- `-gh, --gamma_h`：同态滤波器高频增益（默认: 2.0）
- `-v, --visualize`：可视化处理过程（现在默认启用）

示例:
```bash
# 直接运行程序（自动显示可视化结果）
python homomorphic_filter_app.py

# 指定自定义参数
python homomorphic_filter_app.py -i images/test.jpg -o images/result.png -c 40 -gl 0.5 -gh 2.0
```

## 输出文件

程序会生成以下输出文件：

1. **处理结果图像**：由`--output`参数指定的路径（默认为`images/result.png`）
2. **原图与处理图对比**：保存在与结果图像同目录下，文件名为`[结果文件名]_comparison.png`
3. **可视化处理过程**：保存为`images/process_result.png`和`images/comparison.png`

## 参数说明

### 截止频率 (cutoff)
控制滤波器的截止频率，较大的值会增强更多的高频成分。推荐值：30-50。

### 低频增益 (gamma_l)
控制低频成分的增益，通常设置为小于1的值，以抑制低频。推荐值：0.3-0.6。

### 高频增益 (gamma_h)
控制高频成分的增益，通常设置为大于1的值，以增强高频。推荐值：1.5-2.5。

## 实验步骤

程序按照以下步骤处理图像：

1. 对数变换：将乘性噪声转换为加性噪声
2. 傅里叶变换：将图像转换到频域
3. 频域滤波：应用高斯同态滤波器
4. 逆傅里叶变换：将滤波后的频谱转回空域
5. 指数变换：恢复对数变换，得到最终结果

## 彩色图像处理

程序支持彩色图像处理，处理流程如下：

1. 将RGB图像转换为HSV颜色空间
2. 只对V通道（亮度）应用同态滤波
3. 保持H（色相）和S（饱和度）通道不变
4. 将处理后的HSV图像转换回RGB空间

这种方法可以保持图像的色彩信息，同时改善亮度分布和对比度。

## 高斯同态滤波器

高斯同态滤波器的传递函数为：
$H(u,v) = (γ_h - γ_l) \cdot (1 - e^{-D^2(u,v)/2D_0^2}) + γ_l$

其中：
- $D(u,v)$ 是频域中点 $(u,v)$ 到原点的距离
- $D_0$ 是截止频率
- $γ_l$ 是低频增益
- $γ_h$ 是高频增益

## 图像处理优化

为了获得更好的处理效果，程序进行了以下优化：

1. **亮度调整**：使用gamma校正（γ=0.5）使图像亮度适中
2. **边缘增强**：通过提高高频增益增强图像边缘细节
3. **自动可视化**：程序运行时自动显示处理过程和结果对比，无需额外参数
4. **彩色处理**：支持彩色图像处理，保持色彩信息的同时改善亮度分布 