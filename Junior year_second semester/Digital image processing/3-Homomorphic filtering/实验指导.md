# 实验三、同态滤波

## 一、实验目的
1. 掌握图像乘性噪声的数学模型及分离原理。
2. 理解对数变换在噪声处理中的作用，实现乘性噪声到广义加性噪声的转换。
3. 学习频域分析（FFT/IFFT）在图像处理中的应用。
4. 掌握频域增益曲线的设计与调整方法，抑制噪声并恢复图像。

## 二、实验原理
### 1. 乘性噪声模型
图像中乘性噪声模型可表示为：
$$
g(x,y) = f(x,y) \cdot \eta(x,y) + \varepsilon(x,y)
$$
其中 $f(x,y)$ 为原始图像，$\eta(x,y)$ 为乘性噪声，$\varepsilon(x,y)$ 为加性噪声。实验中重点处理乘性噪声。

### 2. 对数变换
对图像进行对数操作，将乘性噪声转换为广义加性噪声：
$$
\ln(g(x,y)) \approx \ln(f(x,y)) + \ln(\eta(x,y))
$$

### 3. 频域分析（FFT）
通过快速傅里叶变换（FFT）将信号转换到频域，噪声和图像信号的频率成分在频谱图中呈现不同分布。

### 4. 频域滤波（增益曲线）
设计增益函数 $H(u,v)$，抑制噪声对应的频率成分，增强图像信号。

### 5. 逆变换与恢复
通过逆傅里叶变换（IFFT）和指数操作恢复图像：
$$
\hat{f}(x,y) = \exp\left(\text{IFFT}\left[H(u,v) \cdot \text{FFT}(\ln(g(x,y)))\right]\right)
$$

## 三、实验内容
1. 对数变换预处理  
   读取含乘性噪声的图像（如斑点噪声），进行对数变换。
2. 频域分解  
   对变换后信号进行FFT，分析频谱图并定位噪声成分。
3. 频域滤波  
   设计增益曲线（如带阻滤波器），抑制噪声频率。
4. 图像恢复  
   执行IFFT和指数变换，输出处理后的图像。

## 四、实验步骤
1. 对数变换
2. 傅里叶变换于频域分析
3. 设计增益曲线
4. 频域滤波与逆变换
5. 结果显示与对比

## 五、思考题
### 1. 理论分析
- 为什么对数变换能将乘性噪声转换为加性噪声？是否所有乘性噪声都适用此方法？
- 频域处理相比空域处理有何优势？列举至少两种频域滤波器的设计方法。

### 2. 实验分析
- 若增益曲线设计不合理（如过度抑制高频），恢复图像会出现何种失真？
- 实验中对数变换后为何需要添加微小量（如 $1e-6$）？若省略此操作会引发什么问题？

### 3. 拓展思考
- 若图像中同时存在加性噪声和乘性噪声，如何改进实验方法？
- 频域增益曲线是否可以通过自适应方法（如维纳滤波）优化？试说明原理。

## 六、注意事项
1. 实验前需备份原始图像，避免数据处理错误导致数据丢失。
2. 频域滤波后需保留复数结果的实部，避免直接取模导致信息损失。
3. 恢复图像后需进行动态范围调整（如归一化到 [0,1]）再显示。