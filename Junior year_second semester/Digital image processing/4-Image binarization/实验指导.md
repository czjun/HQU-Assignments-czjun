# 实验四、 基于大津法（OTSU算法）的图像二值化

## 一、实验目的
1.掌握大津法（OTSU算法）的基本数学原理及其在图像分割中的应用。
2.熟悉图像二值化的流程，包括颜色空间转换、直方图统计与阈值选择。
3.通过编程实践，理解自动阈值分割的实现过程。

## 二、实验原理
### 1.颜色空间变换
常见的彩色图像为 RGB 格式，但 RGB 空间在某些图像处理任务中存在局限性。因此，通常需要将 RGB 图像转换为其他颜色空间（如灰度空间）。
灰度化公式：Y=0.299R+0.587G+0.114B，其中 R、G、B 分别代表红色、绿色和蓝色分量的值，Y 为灰度值。

### 2.直方图统计
灰度直方图是图像灰度分布的统计图，横轴表示灰度值（0~255），纵轴表示该灰度值的像素数量。
通过直方图可以直观地了解图像的灰度分布情况，为后续的阈值选择提供依据。

### 3.大津法原理
假设图像被分为前景和背景两部分，分别用阈值 T 将图像分为两个类别 C0​（背景）和 C1​（前景）。
计算每个阈值 T 下的类间方差 ，公式为：

其中，ω0​ 和 ω1​ 分别为背景和前景的像素占比，μ0​ 和 μ1​ 分别为背景和前景的平均灰度值。
选择使类间方差 最大的阈值 T 作为最佳阈值。

### 4.二值化处理
根据确定的最佳阈值 T，将图像中的像素分为两类：
如果像素灰度值 I(x,y)≥T，则该像素属于前景，赋值为 255（白色）。
如果像素灰度值 I(x,y)<T，则该像素属于背景，赋值为 0（黑色）。

## 三、实验步骤
1.读取图像并转换颜色空间
o使用 uigetfile 交互选择图像，读取后转换为灰度图（rgb2gray）。
o若图像为RGB三通道，保留前三个通道并转换为灰度；单通道直接使用。

2.统计灰度直方图
o使用 imhist 统计灰度分布，归一化得到概率直方图 p(i)。

3.计算最佳阈值
o遍历有效灰度范围（忽略极低频率的灰度值），计算每个 T 的类间方差 。
o找到使 最大的阈值 T∗ 。

4.图像二值化
o根据 T∗ 生成二值图像

5.可视化结果
o展示原图、直方图、类间方差曲线及二值化结果。

## 四、实验内容
### 1.代码运行与调试
o在MATLAB中运行提供的代码，观察各步骤输出。
o关键代码解释：
nhist = imhist(I)'：统计直方图。
Sigma_BV 计算类间方差，[v3, T] = max(Sigma_BV) 确定最佳阈值。
imgBW = (I > T)：生成二值图像。

### 2.参数调整实验
o修改直方图有效范围（nhist >= 10），观察阈值变化。
o手动设置阈值，对比与大津法的分割效果差异。

### 3.扩展实验
o尝试对多峰直方图的图像（如复杂背景图片）应用大津法，分析其局限性。

## 五、思考题
### 1.算法分析
o大津法假设图像的直方图具有双峰性。若直方图为单峰或多峰，该方法是否仍然有效？为什么？
o类间方差最大化与类内方差最小化有何联系？试从数学角度解释。

### 2.实践改进
o如何优化代码中的循环计算以提高效率？（提示：向量化操作）
o若图像光照不均，大津法可能失效。请提出一种改进策略。

### 3.对比实验
o手动选择阈值与自动选择阈值的优缺点是什么？列举实际应用场景。

## 注意事项
1.代码中忽略灰度频率低于10的区间，避免噪声干扰。
2.若 sum(phist(1:i)) 或 sum(phist(i+1:256)) 为0，需添加异常处理（代码中已通过 nhist(i) > 0 规避）。